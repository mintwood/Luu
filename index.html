from IPython.display import display, HTML

# 再度HTMLコードを表示（コード実行環境がリセットされたため）
html_code = """
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>アンケートテスト</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f9f9f9; }
    .container { max-width: 500px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    .stars { display: flex; justify-content: center; margin: 20px 0; }
    .stars label { font-size: 2rem; color: #ccc; cursor: pointer; padding: 0 5px; }
    .stars input { display: none; }
    .stars input:checked ~ label,
    .stars label:hover,
    .stars label:hover ~ label { color: gold; }
    textarea, button { width: 100%; margin-top: 10px; padding: 10px; font-size: 1rem; }
    .hidden { display: none; }
    .copy-block { margin-top: 20px; background: #f1f1f1; padding: 10px; border-radius: 5px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>◯◯店 サービスアンケート</h1>
    <div class="stars">
      <input type="radio" name="star" id="star5" value="5"><label for="star5">★</label>
      <input type="radio" name="star" id="star4" value="4"><label for="star4">★</label>
      <input type="radio" name="star" id="star3" value="3"><label for="star3">★</label>
      <input type="radio" name="star" id="star2" value="2"><label for="star2">★</label>
      <input type="radio" name="star" id="star1" value="1"><label for="star1">★</label>
    </div>
    <textarea id="comment" placeholder="ご意見・ご感想をお書きください"></textarea>
    <button onclick="handleSubmit()">送信</button>
    <div id="result" class="hidden"></div>
  </div>

  <script>
    function handleSubmit() {
      const star = document.querySelector('input[name="star"]:checked');
      const comment = document.getElementById("comment").value.trim();
      const result = document.getElementById("result");
      result.classList.remove("hidden");
      result.innerHTML = "";

      if (!star) {
        alert("星評価を選択してください。");
        return;
      }

      const rating = parseInt(star.value);

      if (rating >= 3) {
        const message = `<p>ご感想ありがとうございました。<br>このコメントをGoogleレビューに投稿しますか？<br><small>※ご投稿はもちろん任意です。</small></p>`;
        const commentBlock = comment ? `<div class="copy-block"><textarea readonly>${comment}</textarea><button onclick="copyComment()">この内容をコピー</button></div>` : "";
        const buttons = `
          <button onclick="window.open('https://search.google.com/local/writereview?placeid=ChIJbShvzA6NGGAR-mNLA_ED9t8','_blank')">はい、投稿する</button>
          <button onclick="document.getElementById('result').innerHTML='ご協力ありがとうございました。'">今回は投稿しない</button>`;
        result.innerHTML = commentBlock + message + buttons;
      } else {
        result.innerHTML = "<p>この後の低評価フローは別途設計中です。</p>";
      }
    }

    function copyComment() {
      const text = document.querySelector(".copy-block textarea").value;
      navigator.clipboard.writeText(text).then(() => {
        alert("コメントをコピーしました！");
      });
    }
  </script>
</body>
</html>
"""

display(HTML(html_code))
