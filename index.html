<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>◯◯店 サービスアンケート</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; }
    .hidden { display: none; }
    .step { margin-top: 20px; }
    .button { margin-top: 10px; padding: 8px 16px; }
    .star-rating span { font-size: 24px; cursor: pointer; }
    .selected { color: gold; }
    textarea { width: 100%; height: 80px; }
  </style>
</head>
<body>
  <h1>◯◯店 サービスアンケート</h1>
  
  <!-- 初期UI：星評価、コメント欄、送信ボタン -->
  <div id="initialForm">
    <div class="star-rating" id="starRating">
      <span data-value="1">&#9733;</span>
      <span data-value="2">&#9733;</span>
      <span data-value="3">&#9733;</span>
      <span data-value="4">&#9733;</span>
      <span data-value="5">&#9733;</span>
    </div>
    <textarea id="comment" placeholder="ご意見・ご感想をお書きください"></textarea>
    <br>
    <button id="submitBtn" class="button">送信</button>
  </div>
  
  <!-- 低評価用ステップ（★1〜2）：Googleレビュー投稿画面へのボタンはなし -->
  <div id="lowRatingSteps" class="hidden">
    <div class="step">
      <label>【ステップ1】ご不満に思われた点をお聞かせください：</label><br>
      <textarea id="lowStep1"></textarea>
    </div>
    <div class="step">
      <label>【ステップ2】どのような改善があればよかったと感じられましたか？：</label><br>
      <textarea id="lowStep2"></textarea>
    </div>
    <div class="step">
      <label>【ステップ3】今回のようなことは以前にもありましたか？</label><br>
      <input type="radio" name="lowStep3" value="はい">はい
      <input type="radio" name="lowStep3" value="いいえ">いいえ
    </div>
    <div class="step">
      <label>【ステップ4】今後またご来店いただけますか？</label><br>
      <input type="radio" name="lowStep4" value="はい">はい
      <input type="radio" name="lowStep4" value="いいえ">いいえ
    </div>
    <div class="step">
      <p>ご感想ありがとうございました。<br>
      もしこの内容が、これからご来店を検討される方の参考になると感じられましたら、◯◯（店舗名）とGoogleで検索いただくことで、投稿も可能です。<br>
      ※ご投稿はもちろん任意です。</p>
    </div>
  </div>
  
  <!-- 高評価用ステップ（★3〜5） -->
  <div id="highRatingSteps" class="hidden">
    <div class="step" id="highCommentDisplay">
      <!-- 入力されたコメントが表示される -->
    </div>
    <div class="step" id="copyButtonSection">
      <button id="copyCommentBtn" class="button">このコメントをコピー</button>
    </div>
    <div class="step">
      <p>ご感想ありがとうございました。<br>
      このコメントをGoogleレビューに投稿しますか？<br>
      ※ご投稿はもちろん任意です。</p>
      <button id="postReviewBtn" class="button">はい、投稿する</button>
      <button id="noPostBtn" class="button">今回は投稿しない</button>
    </div>
  </div>
  
  <script>
    // 評価値とUI制御用変数
    let rating = 0;
    
    // 星評価クリックイベント設定
    const stars = document.querySelectorAll("#starRating span");
    stars.forEach(star => {
      star.addEventListener("click", () => {
        rating = parseInt(star.getAttribute("data-value"));
        // 選択状態を表示
        stars.forEach(s => {
          s.classList.toggle("selected", parseInt(s.getAttribute("data-value")) <= rating);
        });
      });
    });
    
    // 送信ボタンイベント
    document.getElementById("submitBtn").addEventListener("click", () => {
      // 入力コメント取得
      const comment = document.getElementById("comment").value.trim();
      document.getElementById("initialForm").classList.add("hidden");
      
      if(rating <= 2) {
        // 低評価の場合の処理（★1〜2）
        document.getElementById("lowRatingSteps").classList.remove("hidden");
      } else {
        // 高評価の場合の処理（★3〜5）
        document.getElementById("highRatingSteps").classList.remove("hidden");
        // コメントがある場合、表示
        if(comment !== ""){
          document.getElementById("highCommentDisplay").innerText = comment;
        } else {
          document.getElementById("copyButtonSection").classList.add("hidden");
        }
      }
    });
    
    // 高評価：コメントコピー機能
    document.getElementById("copyCommentBtn").addEventListener("click", () => {
      const comment = document.getElementById("comment").value;
      navigator.clipboard.writeText(comment).then(() => {
        alert("コメントがコピーされました");
      });
    });
    
    // 高評価：投稿するボタンでGoogleレビュー画面を新規タブで開く
    document.getElementById("postReviewBtn").addEventListener("click", () => {
      window.open("https://search.google.com/local/writereview?placeid=ChIJbShvzA6NGGAR-mNLA_ED9t8", "_blank");
    });
    
    // 高評価：今回は投稿しないボタン
    document.getElementById("noPostBtn").addEventListener("click", () => {
      alert("ご利用ありがとうございました");
    });
  </script>
</body>
</html>
